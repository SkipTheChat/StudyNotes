# 1 操作系统

### 1.1 操作系统简介

我通过以下四点介绍什么是操作系统：

- **操作系统（Operation System，简称OS）是管理计算机硬件与软件资源的程序，是计算机系统的内核与基石；**
- **操作系统本质上是运行在计算机上的软件程序 ；**
- **为用户提供一个与系统交互的操作界面 ；**
- **操作系统分内核与外壳（我们可以把外壳理解成围绕着内核的应用程序，而内核就是能操作硬件的程序）。**

![操作系统分内核与外壳](https://user-gold-cdn.xitu.io/2018/7/3/1645ee3dc5cf626e?w=862&h=637&f=png&s=23899)



### 1.2 操作系统简单分类

1. **Windows:** 目前最流行的个人桌面操作系统 ，不做多的介绍，大家都清楚。
2. **Unix：** 最早的多用户、多任务操作系统 .按照操作系统的分类，属于分时操作系统。Unix 大多被用在服务器、工作站，现在也有用在个人计算机上。它在创建互联网、计算机网络或客户端/服务器模型方面发挥着非常重要的作用。 ![Unix](https://user-gold-cdn.xitu.io/2018/7/3/1645ee83f036846d?w=1075&h=475&f=png&s=914462)
3. **Linux:** Linux是一套免费使用和自由传播的类Unix操作系统.Linux存在着许多不同的Linux版本，但它们都使用了 **Linux内核**   。Linux可安装在各种计算机硬件设备中，比如手机、平板电脑、路由器、视频游戏控制台、台式计算机、大型机和超级计算机。严格来讲，Linux这个词本身只表示Linux内核，但实际上人们已经习惯了用Linux来形容整个基于Linux内核，并且使用GNU  工程各种工具和数据库的操作系统。

![Linux](https://user-gold-cdn.xitu.io/2018/7/3/1645eeb8e843f29d?w=426&h=240&f=png&s=32650)



# 2 Linux

### 2.1 Linux的分类

**Linux根据原生程度，分为两种：**

1. **内核版本：** Linux不是一个操作系统，严格来讲，**Linux只是一个操作系统中的内核**。内核是什么？内核建立了计算机软件与硬件之间通讯的平台，内核提供系统服务，比如文件管理、虚拟内存、设备I/O等；
2. **发行版本：** 一些组织或公司在内核版基础上进行二次开发而重新发行的版本。Linux发行版本有很多种（ubuntu和CentOS用的都很多，初学建议选择CentOS），如下图所示： ![Linux发行版本](https://user-gold-cdn.xitu.io/2018/7/3/1645efa7048fd018?w=548&h=274&f=png&s=99213)



### 3.3 Linux文件系统

**在Linux操作系统中，所有被操作系统管理的资源，例如网络接口卡、磁盘驱动器、打印机、输入输出设备、普通文件或是目录都被看作是一个文件。**

也就是说在LINUX系统中有一个重要的概念：**一切都是文件**。其实这是UNIX哲学的一个体现，而Linux是重写UNIX而来，所以这个概念也就传承了下来。在UNIX系统中，把一切资源都看作是文件，包括硬件设备。UNIX系统把每个硬件都看成是一个文件，通常称为设备文件，这样用户就可以用读写文件的方式实现对硬件的访问。



### 3.4 文件类型与目录结构

**Linux支持5种文件类型 ：** ![文件类型](https://user-gold-cdn.xitu.io/2018/7/3/1645f1a7d64def1a?w=901&h=547&f=png&s=72692)

**Linux的目录结构如下：**

Linux文件系统的结构层次鲜明，就像一棵倒立的树，最顶层是其根目录： ![Linux的目录结构](https://user-gold-cdn.xitu.io/2018/7/3/1645f1c65676caf6?w=823&h=315&f=png&s=15226)

**常见目录说明：**

- **/bin：** 存放二进制可执行文件(ls、cat、mkdir等)，常用命令一般都在这里；
- **/etc：**  存放系统管理和配置文件；
- **/home：**  存放所有用户文件的根目录，是用户主目录的基点，比如用户user的主目录就是/home/user，可以用~user表示；
- **/usr ：** 用于存放系统应用程序；
- **/opt：** 额外安装的可选应用程序包所放置的位置。一般情况下，我们可以把tomcat等都安装到这里；
- **/proc：**  虚拟文件系统目录，是系统内存的映射。可直接访问这个目录来获取系统信息；
- **/root：**  超级用户（系统管理员）的主目录（特权阶级^o^）；
- **/sbin:**  存放二进制可执行文件，只有root才能访问。这里存放的是系统管理员使用的系统级别的管理命令和程序。如ifconfig等；
- **/dev：** 用于存放设备文件；
- **/mnt：** 系统管理员安装临时文件系统的安装点，系统提供这个目录是让用户临时挂载其他的文件系统；
- **/boot：**  存放用于系统引导时使用的各种文件；
- **/lib ：**      存放着和系统运行相关的库文件 ；
- **/tmp：** 用于存放各种临时文件，是公用的临时文件存储点；
- **/var：** 用于存放运行时需要改变数据的文件，也是某些大文件的溢出区，比方说各种服务的日志文件（系统启动日志等。）等；
- **/lost+found：**  这个目录平时是空的，系统非正常关机而留下“无家可归”的文件（windows下叫什么.chk）就在这里。



### 3.5 linux基本命令

##### 3.5.1 目录切换命令

- **cd usr：**   切换到该目录下usr目录  
- **cd ..（或cd../）：**  切换到上一层目录 
- **cd /：**   切换到系统根目录  
- **cd ~：**   切换到用户主目录 
- **cd -：**   切换到上一个操作所在目录



##### 3.5.2 目录的操作命令(增删改查)

1. **mkdir：** 创建文件

2. **ls或者ll**：查看目录信息（ll是ls -l的别名，ll命令可以看到该目录下的所有目录和文件的详细信息）

3. **find 目录 参数：** 寻找目录

    示例：

   - 列出当前目录及子目录下所有文件和文件夹: `find .`
   - 在`/home`目录下查找以.txt结尾的文件名:`find /home -name "*.txt"`
   - 同上，但忽略大小写: `find /home -iname "*.txt"`
   - 当前目录及子目录下查找所有以.txt和.pdf结尾的文件:`find . \( -name "*.txt" -o -name "*.pdf" \)`或`find . -name "*.txt" -o -name "*.pdf"`

   

4. **mv 目录名称 新目录名称：** 修改的名称

   

5. **mv 目录名称 目录的新位置：** 剪切

    

6. **cp -r 目录名称 目录拷贝的目标位置：** 拷贝文件，-r代表递归拷贝 

    

7. **rm [-rf] 目录:** 删除目录

   > 注意：无论删除任何目录或文件，都直接使用`rm -rf` 目录/文件/压缩包

   

##### 3.5.3 文件的操作命令(增删改查)

1. **touch 文件名称:**  文件的创建

2. **cat/more/less/tail 文件名称** 文件的查看

   - **cat：** 查看显示文件内容
   - **more：** 可以显示百分比，回车可以向下一行， 空格可以向下一页，q可以退出查看
   - **less：** 可以使用键盘上的PgUp和PgDn向上 和向下翻页，q结束查看
   - **tail-10 ：** 查看文件的后10行，Ctrl+C结束

   

3. **vim 文件：**  修改文件的内容

4. **rm -rf 文件：** 删除文件

   

##### 3.5.4 压缩文件的操作命令

1. 打包并压缩文件：

    命令：`tar -zcvf 打包压缩后的文件名 要打包压缩的文件` 

     z：调用gzip压缩命令进行压缩

     c：打包文件

     v：显示运行过程

     f：指定文件名



2. 解压压缩包：

   命令：`tar [-xvf] 压缩文件`

   其中：x：代表解压



##### 3.5.5 Linux的权限命令

   在Linux中权限一般分为读(readable)、写(writable)和执行(excutable)，分为三组。分别对应文件的属主(owner)，属组(group)和其他用户(other)

`chmod`



##### 3.5.6 查看磁盘/内存/CPU使用情况 

**1. df -h 查看磁盘剩余空间信息**

> 显示格式为：　
>
> 文件系统  容量  已用  可用  已用%  挂载点　
>
> Filesystem  Size  Used  Avail  Use%  Mounted on

![img](http://dl2.iteye.com/upload/attachment/0131/5186/99e3a4db-3bbd-3192-84ad-46e82e134d30.png)

 

**2. free -h 命令是一个快速查看内存使用情况的方法**

> 显示格式为：　
>
> 总数  已用  空闲  共享内存总额  缓存内存数  可用内存
>
> total  used  free  shared  buff/cache  available

Swap当系统的物理内存不够用的时候，就需要将物理内存中的一部分空间释放出来，以供当前运行的程序使用。这些被释放的进程被临时保存到Swap空间中，等到那些程序要运行时，再从Swap分区中恢复保存的数据到内存中。这样，系统总是在物理内存不够时，才进行Swap交换。所以swap分区不被占用或者占用很少，说明现在系统内存够用，运行还算良好，不会影响系统运行

![img](http://dl2.iteye.com/upload/attachment/0131/5188/f29b9b62-4162-359a-a1ea-0c083c561586.png)

 

**3. sar -u 查看CPU使用情况**

每1秒收集一次，共收集5次

> sar -u 1 5

CPU：all表示统计信息为所有 CPU的平均值。

%user：显示在用户级别(application)运行使用 CPU 总时间的百分比。

%nice：显示在用户级别，用于nice操作，所占用 CPU总时间的百分比。

%system：在核心级别(kernel)运行所使用 CPU总时间的百分比。

%iowait：显示用于等待I/O操作占用 CPU总时间的百分比。

%steal：管理程序(hypervisor)为另一个虚拟进程提供服务而等待虚拟 CPU 的百分比。

%idle：显示 CPU空闲时间占用 CPU总时间的百分比。

![img](http://dl2.iteye.com/upload/attachment/0131/5190/ded88921-16d6-3542-bed2-3e8b869450a4.png)

P.S

1. 若 %iowait的值过高，表示硬盘存在I/O瓶颈
2. 若 %idle的值高但系统响应慢时，有可能是 CPU等待分配内存，此时应加大内存容量
3. 若 %idle的值持续低于1，则系统的 CPU处理能力相对较低，表明系统中最需要解决的资源是 CPU。

 

**4. top**

top命令的顶部显示与uptime命令相似的输出

这些字段显示：当前时间、系统已运行的时间、当前登录用户的数量、相应最近5、10和15分钟内的平均负载。

![img](http://dl2.iteye.com/upload/attachment/0131/5192/6c51a135-1390-37ee-af59-5cd6a0081057.png)

Tasks任务（进程）：

系统现在共有144个进程，其中处于运行中的有1个，143个在休眠（sleep），stoped状态的有0个，zombie状态（僵尸）的有0个。

 

CPU 状态:

us, user： 运行(未调整优先级的) 用户进程的CPU时间

sy，system: 运行内核进程的CPU时间

ni，niced：运行已调整优先级的用户进程的CPU时间

wa，IO wait: 用于等待IO完成的CPU时间

hi：处理硬件中断的CPU时间

si: 处理软件中断的CPU时间

st：这个虚拟机被hypervisor偷去的CPU时间（译注：如果当前处于一个hypervisor下的vm，实际上hypervisor也是要消耗一部分CPU处理时间的）

 

内存使用：

509248k total — 物理内存总量（509M）

495964k used — 使用中的内存总量（495M）

13284k free — 空闲内存总量（13M）

25364k buffers — 缓存的内存量 （25M）

swap交换分区

492536k total — 交换区总量（492M）

11856k used — 使用的交换区总量（11M）

480680k free — 空闲交换区总量（480M）

202224k cached — 缓冲的交换区总量（202M）



##### 3.5.7 其他常用命令

**网络通信命令：**

- 查看当前系统的网卡信息：**ifconfig**
- 查看与某台机器的连接情况：ping 
- 查看当前系统的端口使用：netstat -an

**查看进程命令：**

ps

- -a，查看所有

- -u，以用户（user）的格式显示

- -x, 显示后台进程运行参数

- -ef，以全格式显示进程所有信息，包括父进程Pid，创建人，创建时间，进程号。等等


一般项目中，我们首先要查询一个进程，并对其进行删除会用一下命令

- ps -a | grep helloworld 或

- ps -ef |grep helloworld 或者其他


查询到helloworld相关的进程，我们通过kill命令来操作该进程号删除该进程，kill -9  13492



##### 3.5.6 其他常用命令

- **pwd：** 显示当前所在位置

- **sudo + 其他命令：**以系统管理者的身份执行指令，也就是说，经由 sudo 所执行的指令就好像是 root 亲自执行。

- **grep 要搜索的字符串 要搜索的文件 --color：** 

- **ps -ef/ps -aux：** 这两个命令都是查看当前系统正在运行进程，两者的区别是展示格式不同。如果想要查看特定的进程可以使用这样的格式：**ps aux|grep redis** （查看包括redis字符串的进程），也可使用 `pgrep redis -a`。

  注意：如果直接用ps（（Process Status））命令，会显示所有进程的状态，通常结合grep命令查看某进程的状态。

- **kill -9 进程的pid：** 杀死进程（-9 表示强制终止。）

  先用ps查找进程，然后用kill杀掉

  

  

     **Linux如果cpu满了，用什么命令?**    

     **找到线程之后用什么命令？**    

  - 能简单使用 cat，grep，cut 等命令进行一些操作；
  - 文件系统相关的原理，inode 和 block 等概念，数据恢复；
  - 硬链接与软链接；
  - 进程管理相关，僵尸进程与孤儿进程，SIGCHLD 。

  